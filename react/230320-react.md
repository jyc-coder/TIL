# json-server, cookie


## Json Server ì‚¬ìš©í•´ì„œ ë°±ì—”ë“œ ì²´í—˜

### 1) json server
ê°„ë‹¨í•˜ê²Œ ë°±ì—”ë“œ ì„œë²„ë¥¼ êµ¬ì¶•í• ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ì—­í• 

ì§ì ‘ ê¸€ì„ ìƒì„±, ìˆ˜ì •, ì‚­ì œí•˜ëŠ” ì‘ì—…ê¹Œì§€ json serverë¥¼ ì´ìš©í•´ì„œ ì§„í–‰í•œë‹¤.

> yarn add json-server


### 2) ì„œë²„ ë§Œë“¤ê¸°

ì•± ìµœìƒë‹¨ ê²½ë¡œì— ì•„ë˜ì™€ ê°™ì€ í˜•íƒœë¡œ db.jsonì„ ì œì‘í•œë‹¤.

```json
{
  "posts": [
    {
      "title": "First Post",
      "body": "First Content",
      "id": 1
    }
  ]
}
```

ìœ„ì²˜ëŸ¼ ì‘ì„±í•˜ê³ , ì„œë²„ë¥¼ ì‹¤í–‰í•œ í›„ì—, ì„œë²„ì£¼ì†Œ/postsë¡œ ì ‘ê·¼í•˜ë©´ í•´ë‹¹ ë°°ì—´ì•ˆì— ì‡ëŠ” ë‚´ìš©ë“¤ì„ ìˆ˜ì •/ì‚­ì œ/ìƒì„/ì½ê¸°ê°€ ê°€ëŠ¥í•˜ê²Œ ëœë‹¤.

ê·¸ë¦¬ê³   package.json ì˜ scripts ë¶€ë¶„ì„ ì•„ë˜ì²˜ëŸ¼ ìˆ˜ì •í•œë‹¤
```json
  "scripts": {
        "dev": "vite",
        "build": "vite build",
        "preview": "vite preview",
        "server": "json-server --watch db.json --port 8000"
    },
```

### 3) postman ì‚¬ìš©í•˜ê¸°

[https://www.postman.com/downloads/](https://www.postman.com/downloads/) : ì„¤ì¹˜ë§í¬


ì•„ê¹Œ ì‹¤í–‰í•´ì„œ ì¼œë†“ì€ ì„œë²„ ì£¼ì†Œë¥¼  + postsë¥¼ ì…ë ¥í•˜ê³  send ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ í•˜ë‹¨ë¶€ë¶„ì— ì‘ë‹µì´ í‘œì‹œëœë‹¤.


![](https://velog.velcdn.com/images/jhs000123/post/f610465b-752b-44f6-992b-f4fa78e1d614/image.png)


ì´ì œ GET ëŒ€ì‹ ì— POSTë¡œ ë³€ê²½í•˜ê³  Body ì„ íƒ í›„ì— rawë¥¼ í´ë¦­í•œ ë‹¤ìŒ ê°€ì¥ ìš°ì¸¡ì— ìˆëŠ” íƒ€ì…ì„ jsonìœ¼ë¡œ ë°”ê¾¼ë‹¤.
ê·¸ë¦¬ê³  í•˜ë‹¨ì˜ í…ìŠ¤íŠ¸ ì…ë ¥ì°½ì— `{â€titleâ€: â€œì œëª©", â€œbodyâ€: â€œë‚´ìš©â€}` ì™€ ê°™ì€ ë°©ì‹ìœ¼ë¡œ ì‘ì„±í•´ì„œ sendë¥¼ ëˆŒëŸ¬ë³¸ë‹¤.

![](https://velog.velcdn.com/images/jhs000123/post/f74641c5-ffd2-4136-98ec-9d256ceb8bba/image.png)

ì´ì œ ë‹¤ì‹œ GETìœ¼ë¡œ í™•ì¸í•´ë³´ë©´ 

![](https://velog.velcdn.com/images/jhs000123/post/dabb7dcf-53e6-4d1d-8c67-98e8c7e174bf/image.png)

ê¸€ 2ê°œê°€ ì¶”ê°€ë˜ì–´ìˆë‹¤.

DELETE ë‚˜ PUT ë„ ê°€ëŠ¥í•˜ë‹¤. 
DELETEì˜ ê²½ìš°ì—ëŠ” posts ë’¤ì— `/ê¸€id`ë¥¼ ë¶™ì—¬ì„œ ìš”ì²­ì„ ë³´ë‚´ë©´ ëœë‹¤.
PUT ë„ ë§ˆì°¬ê°€ì§€ë¡œ ì˜ ì‘ë™í•œë‹¤.


### 4) rdb?

rdbë€ relational databaseë¥¼ ëœ»í•œë‹¤.
ë°ì´í„°ë² ì´ìŠ¤ëŠ” ë°ì´í„°ë² ì´ìŠ¤ì¸ë°, ì•„ëŠì´ ë°ì´í„°ë“¤ì´ ì„œë¡œ ê´€ê³„ë¥¼ ë§ºìœ¼ë©´ì„œ ì´ë£¨ì–´ì ¸ìˆë‹¤ëŠ” ëœ»ì´ë‹¤.

ì •ë³´ë¥¼ ì €ì¥í•˜ê¸° ìœ„í•´ì„œëŠ” dbê°€ í•„ìˆ˜ì ì´ë‹¤.
db ë‚´ë¶€ì—ì„œ íŠ¹ì • ì •ë³´ì— ëŒ€í•´ì„œ ì •ë³´ë¥¼ ë‹´ëŠ” ê³µê°„ì„ `í…Œì´ë¸”` ì´ë¼ê³  í•œë‹¤.
[Oë¹„ìœ ë¥¼ í•˜ìë©´, dbëŠ” ì•¡ì…€ íŒŒì¼ì´ê³ , í…Œì´ë¸”ì€ ì—‘ì…€ íŒŒì¼ ë‚´ë¶€ì˜ ì‹œíŠ¸ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤!
ì‹œíŠ¸ë¥¼ ì—¬ëŸ¬ê°œ ë§Œë“¤ìˆ˜ ìˆë“¯ì´, í…Œì´ë¸”ë„ ì—¬ëŸ¬ê°œë¥¼ ë§Œë“¤ìˆ˜ ìˆë‹¤.

ìœ ì €ê°€ ê¸€ì“°ëŠ” ê¸°ëŠ¥ì„ ë§Œë“ ë‹¤ê³  ìƒê°í•˜ë©´,
user í…Œì´ë¸”ê³¼ post í…Œì´ë¸”ì´ ê°ê° ì¡´ì¬í•´ì•¼í•œë‹¤.

í…Œì´ë¸”ì€ ì•„ë˜ì™€ ê°™ì´ ìƒê²¼ë‹¤ê³  ìƒê°í•´ë³´ë©´ 

`post í…Œì´ë¸”`

id | title | body | userId
:--:|:--:|:--:|:--:
1|ì œëª©1|ë‚´ìš©1|1|
2|ì œëª©2|ë‚´ìš©2|2|



`post í…Œì´ë¸”`

id | name | password
:--:|:--:|:--:|
1|ë°”ì§€ë½|1234|
2|ì¹¼êµ­ìˆ˜|123|

ìš°ë¦¬ëŠ” Post í…Œì´ë¸” ë‚´ë¶€ì˜ userId ë¥¼ ë³´ê³ , User í…Œì´ë¸”ë¡œ ê°€ì„œ í•´ë‹¹ ìœ ì €ì˜ ì´ë¦„ì„ ì•Œ ìˆ˜ ìˆë‹¤.

id ê°€ 1ì¸ ê¸€ì˜ ê²½ìš°, userId ê°€ 1 ì´ë¯€ë¡œ, User í…Œì´ë¸”ì—ì„œ id ê°€ 1ì¸ ì‚¬ëŒì„ ì°¾ìœ¼ë©´, â€˜ë°”ì§€ë½' ì´ë¼ëŠ” ì‚¬ëŒì´ ê¸€ì„ ì¼ë‹¤ëŠ” ê²ƒì„ ì•Œ ìˆ˜ ìˆëŠ” ê²ƒì´ì£ !

ì´ë ‡ê²Œ í…Œì´ë¸”ì„ ì„œë¡œ ì—°ê²°ì§“ëŠ” í•„ë“œë¥¼ `foreign key` ë¼ê³  í•œë‹¤.

ê·¸ë¦¬ê³  ì´ë ‡ê²Œ idë¡œ íŠ¹ì •í•œ ìœ ì €ë¥¼ êµ¬ë¶„ì§“ê¸° ìœ„í•´ì„œëŠ” , í•´ë‹¹ id ê°€ unique í•´ì•¼ í•œë‹¤. ë‹¤ë¥¸ ìœ ì €ë‘ id ê°€ ë˜‘ê°™ë‹¤ë©´ userId ë§Œìœ¼ë¡œ ë‹¤ë¥¸ ìœ ì €ì™€ êµ¬ë³„ì„ ì§€ì„ìˆ˜ ì—†ê²Œ ëœë‹¤.

ê·¸ë˜ì„œ ì´ë ‡ê²Œ ê° í…Œì´ë¸”ë§ˆë‹¤ ì¡´ì¬í•˜ëŠ” unique í•œ id ë¥¼ `primary key` ë¼ê³  í•œë‹¤.

ë³´í†µì€ ì•„ë˜ì™€ ê°™ì´ ì—°ê²° êµ¬ì¡°ë¥¼ í‘œí˜„í•˜ëŠ” diagram ì„ ê·¸ë ¤ì„œ db ì— ëŒ€í•œ ì´ˆê¸° ì„¤ê³„ë¥¼ ì§„í–‰í•˜ê²Œ ëœë‹¤.
![](https://velog.velcdn.com/images/jhs000123/post/cee83bd7-a2c2-4d29-87d6-34225918e8d2/image.png)

## ê°„ë‹¨í•œ ë¸”ë¡œê·¸ ë§Œë“¤ê¸°

### 1) ì½ì–´ì˜¤ê¸° ê¸°ëŠ¥

ì•„ê¹Œ postmanì—ì„œ getìœ¼ë¡œ ë°ì´í„° ì¡°íšŒë¥¼ í•´ì„œ ë‚˜ì˜¨ ë°ì´í„°ë¥¼ reactë¥¼ í†µí•´ ê¸°ëŠ¥ì„ êµ¬í˜„í•´ë³´ì

axiosë¥¼ ì‚¬ìš©í•´ì„œ json-serverì—ì„œ getì„ í†µí•´ ì–»ì€ ë°ì´í„°ë¥¼ ì‚¬ìš©í•´ì„œ Postsì»´í¬ë„ŒíŠ¸ë¥¼ ì œì‘í•œë‹¤.

```jsx
import React, { useEffect, useState } from 'react'
import axios from 'axios'

function Posts() {
    const [data, setData] = useState(null)
    const getData = async () => {
        const response = await axios.get('http://localhost:8000/posts')
        setData(response.data)
    }
    useEffect(() => {
        getData()
    }, [])

    return (
        <div>
            Posts
            {data && data.map((post) => <p key={post.id}>{post.body}</p>)}
        </div>
    )
}

export default Posts

```


### 2) ê¸€ì“°ê¸° ê¸°ëŠ¥


### 3) ìˆ˜ì •/ì‚­ì œ ê¸°ëŠ¥



## íšŒì›ê°€ì… / ë¡œê·¸ì¸ ê¸°ëŠ¥ êµ¬í˜„

### 1) JWT 
jwt ëŠ” json web token ì„ ì¤„ì¸ ë§ë¡œ, íŠ¹ì •í•œ json ë°ì´í„° (ìœ ì € ì •ë³´) ì— ëŒ€í•´ì„œ ì•”í˜¸í™”ë¥¼ í•˜ì—¬, ì´ë¥¼ ìœ ì €ì˜ ì¸ì¦ ì •ë³´ë¡œì„œ ì‚¬ìš©í•œë‹¤.

```json
eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJlbWFpbCI6Im5pbHNvbkBlbWFpbC5jb20iLCJwYXNzd29yZCI6Im5pbHNvbiIsImlhdCI6MTY2MDExMDg0NSwiZXhwIjoxNjYwMTE0NDQ1fQ.SHB0bs4GOxZwyTDMzjJGw0BVLYWr8Q4UsdibJtj54d0
````
ì´ë ‡ê²Œ ìƒê²¼ëŠ”ë°, ì—¬ê¸°ì— ìœ ì € ì •ë³´ì™€ í•¨ê»˜, ì–¸ì œê¹Œì§€ í•´ë‹¹ í† í°ì„ ì“¸ìˆ˜ ìˆëŠ”ì§€ë„ ë‹´ê²¨ìˆë‹¤.

**íŠ¹ì • ìœ ì €ê°€ ë¡œê·¸ì¸ë˜ì—ˆëŠ”ì§€ í™•ì¸í• ë•Œ, ì´ í† í°ì„ ì‚¬ìš©í•œë‹¤.**


ì—¬ê¸°ì— ìœ ì € ì •ë³´ê°€ ë‹´ê²¨ìˆê¸° ë•Œë¬¸ì—, tokenì„ ì´ìš©í•´ì„œ ì–´ë–¤ ìœ ì €ê°€ ì§€ê¸ˆ ë°°ê²ë“œë¡œ ìš”ì²­ì„ ë³´ë‚´ê³  ìˆëŠ”ì§€ë„ í™•ì¸í•  ìˆ˜ ìˆë‹¤.


**ë°±ì—”ë“œëŠ” í”„ë¡ íŠ¸ì—”ë“œê°€ token ì„ ê°€ì§„ ìƒíƒœ (header ì— token ì„ ë„£ì€ ìƒíƒœ) ë¡œ ìš”ì²­ì„ ë³´ë‚´ë©´, ì´ token ì´ ìœ íš¨í•œ token ì¸ì§€ í™•ì¸í•˜ê³ , ëˆ„ê°€ ìš”ì²­ì„ ë³´ë‚¸ê±´ì§€, ì§€ê¸ˆ ì´ ìš”ì²­ì„ ë³´ë‚¼ ê¶Œí•œì´ ìˆëŠ”ì§€ê¹Œì§€ë„ í™•ì¸**í•œë‹¤.

â†’ ë§ˆì¹˜ ìˆ ì§‘ì— ë“¤ì–´ê°ˆ ë•Œ ì‹ ë¶„ì¦ì„ ì œì‹œí•˜ë©´, ì‹ ë¶„ì¦ì´ ìš°ì„  ìœ íš¨í•œ ì‹ ë¶„ì¦ì¸ì§€ í™•ì¸í•˜ê³ , ë‚´ê°€ ëˆ„êµ¬ì¸ì§€ ë³´ë©´ì„œ ì—°ë ¹ì„ í™•ì¸í•˜ëŠ” ê²ƒê³¼ ë¹„ìŠ·í•˜ë‹¤.

- jwt êµ¬ì¡°

HEADER, PAYLOAD, VERIFY_SIGNATURE ë¡œ ì´ë£¨ì–´ì ¸ ìˆìœ¼ë©°, ì•„ë˜ì™€ ê°™ì´ ê° ë°ì´í„°ëŠ” ì˜¨ì (.)ìœ¼ë¡œ êµ¬ë¶„ëœë‹¤.


HEADER ëŠ” JWT ê²€ì¦ì— í•„ìš”í•œ í† í° íƒ€ì…ê³¼ ì•Œê³ ë¦¬ì¦˜ì— ëŒ€í•œ ì •ë³´ë¥¼ ë‹´ê³  ìˆë‹¤. (í˜„ì¬ í† í°ì´ ì–´ë–»ê²Œ ì•”í˜¸í™”ë˜ì–´ìˆëŠ”ì§€ë¥¼ ì €ì¥)


```json
HEADER ì •ë³´
{
  "typ": "JWT",    # í† í° íƒ€ì…
  "alg": "HS256"   # ì•Œê³ ë¦¬ì¦˜
}
```

`PAYLOAD` ëŠ” ì‹¤ì§ˆì ìœ¼ë¡œ ì¸ì¦ì— í•„ìš”í•œ ë°ì´í„°ë¥¼ ì €ì¥í•œë‹¤. ë°ì´í„° ê°ê°ì˜ í•„ë“œë¥¼ **í´ë ˆì„(`claim`)** ì´ë¼ê³  í•˜ê³ , ëŒ€ë¶€ë¶„ì˜ ê²½ìš° í´ë ˆì„ì— `username` ë˜ëŠ” `user_id` ë¥¼ í¬í•¨í•©ë‹ˆë‹¤.

ë˜í•œ í˜ì´ë¡œë“œì—ëŠ” **í† í° ë°œí–‰ì‹œê°„(`iat`)**ì™€ **í† í° ë§Œë£Œì‹œê°„(`exp`)** ì´ ìˆì–´ì„œ, í† í°ì„ í˜„ì¬ ì‹œì ì—ì„œ ì‚¬ìš©í•  ìˆ˜ ìˆëŠ”ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ê¸° ìœ„í•œ ìš©ë„ë¡œë„ ì‚¬ìš©ëœë‹¤.

```json
PAYLOAD ì •ë³´
{
  "token_type": "access", # í† í°ì˜ ì¢…ë¥˜
  "exp": 1656293275, # í† í°ì˜ ë§Œë£Œì‹œê°„
  "iat": 1656293095, # í† í°ì˜ ë°œí–‰ì‹œê°„
  "jti": "3b46ec59ce1e4da641f9f317adb9f6a3", # í† í° ì•„ì´ë””
  "user_id": 1 # ì‚¬ìš©ìì˜ ì•„ì´ë””ê°’
}
```

VERIFY SIGNATURE ëŠ” í† í°ì˜ ì§„ìœ„ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ëŠ” ìš©ë„ë¡œ ì‚¬ìš©ë˜ë©°, header ì™€ payload ê°’ì„ í•©ì¹œ í›„ì—, SECRET_KEY ì™€ í•¨ê»˜ ì•”í˜¸í™” ì•Œê³ ë¦¬ì¦˜ì„ ì‚¬ìš©í•´ì„œ ì•”í˜¸í™” í•œë‹¤.

```jsx
HMACSHA256(
  base64UrlEncode(header) + "." +
  base64UrlEncode(payload),
	SECRET_KEY
)
```

- **Access Token ê³¼ Refresh Token**

jwt ì¸ì¦ ë°©ì‹ì˜ ê²½ìš° ë³´ì•ˆì„ ìœ„í•´ì„œ ë‘ ê°€ì§€ í† í°ì„ í•¨ê»˜ ì‚¬ìš©í•œë‹¤.

1. **Access Token : ë§ê·¸ëŒ€ë¡œ ìš”ì²­ì„ ë³´ë‚¼ ë•Œ (ì ‘ê·¼í•  ë•Œ) ì‚¬ìš©í•˜ëŠ” í† í°.**
2. **Refresh Token : access token ì„ ì¬ë°œê¸‰ë°›ì„ ë•Œ ì‚¬ìš©í•˜ëŠ” í† í°.**

ë‘ ê°€ì§€ë¥¼ í™œìš©í•´ì„œ ì•„ë˜ì™€ ê°™ì´ êµ¬í˜„í•œë‹¤.

1. **access token ì€ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì ‘ê·¼í•  ìˆ˜ ìˆê²Œ ì„¤ì •. ë˜í•œ í˜¹ì‹œë‚˜ access token ì´ íƒˆì·¨ë˜ë”ë¼ë„ ë¬¸ì œê°€ ì—†ë„ë¡, ì¼ë¶€ëŸ¬ access token ì˜ ë§Œë£Œ ì‹œê°„ì„ ì§§ê²Œ ì„¤ì •í•©ë‹ˆë‹¤. í•´ë‹¹ í† í°ì´ ë§Œë£Œë˜ë©´, refresh token ì„ í™œìš©í•´ì„œ ì¬ë°œê¸‰ ë°›ë„ë¡ í•œë‹¤.**
2. **refresh token ì€ í”„ë¡ íŠ¸ì—”ë“œì—ì„œ ìë°”ìŠ¤í¬ë¦½íŠ¸ë¡œ ì ‘ê·¼í•  ìˆ˜ ì—†ë„ë¡ (íƒˆì·¨ë‹¹í•  ìˆ˜ ì—†ë„ë¡) httpOnly ì¿ í‚¤ë¡œ ì„¤ì •. (ë°±ì—”ë“œì—ì„œ ì¿ í‚¤ë¥¼ ì„¤ì •í•˜ëŠ” ì‘ë‹µì„ ë‚´ë ¤ì¤Œ) refresh token ì€ ë§Œë£Œ ì‹œê°„ì„ ê¸¸ê²Œ ì„¤ì •í•´ì„œ, access token ì´ ë§Œë£Œë  ê²½ìš° í•´ë‹¹ í† í°ì„ ì¬ë°œê¸‰ë°›ì„ ìˆ˜ ìˆë„ë¡ í•œë‹¤.**

### 2) json-server-auth ì‚¬ìš©í•˜ê¸°
jwtë¥¼ í•œë²ˆ ì‚¬ìš©í•´ë³´ì.
json server authë¥¼ ì´ìš©í•´ì„œ jwtê¸°ëŠ¥ì´ êµ¬í˜„ëœ ë°±ì—”ë“œë¥¼ ì‹¤í–‰í•´ë³´ì.

> yarn add json-server-auth

- package.jsonìˆ˜ì •

```json
"scripts": {
    "dev": "vite",
    "build": "vite build",
    "preview": "vite preview"
    "server": "json-server-auth --watch db.json --port 8000"
  },
```
- db.json ìˆ˜ì •
```json
{
    "posts": [
        {
            "title": "First Post",
            "body": "First Content",
            "id": 1
        }
    ],
    "users": []
}

```

ì´ì œ yarn serverë¡œ ì„œë²„ë¥¼ ì‹¤í–‰í•˜ê³  

`ì„œë²„ì£¼ì†Œ/register` ë¡œ email, password ë¥¼ ë‹´ì•„ì„œ ìš”ì²­ì„ ë³´ë‚´ë©´ íšŒì›ê°€ì…ì´ ì§„í–‰ëœë‹¤.
![](https://velog.velcdn.com/images/jhs000123/post/6237cf76-e4f8-428b-97f8-7073ea928637/image.png)


`ì„œë²„ì£¼ì†Œ/login` ìœ¼ë¡œ email, password ë¥¼ ë‹´ì•„ì„œ ìš”ì²­ì„ ë³´ë‚´ë©´ ë¡œê·¸ì¸ì´ ì§„í–‰ëœë‹¤.

![](https://velog.velcdn.com/images/jhs000123/post/35df41d8-bf01-4591-a165-3fbcbf154b38/image.png)


ìš”ì²­ì´ ì„±ê³µí•˜ë©´, accessToken ì´ë¼ëŠ” ê³³ì— jwt token ì„ ë‹´ì•„ì„œ ì „ë‹¬í•´ì¤€ë‹¤.


ì´ì œ ì•ìœ¼ë¡œ ìš”ì²­ë³´ë‚¼ ë•Œ `**í•´ë‹¹ tokenì„ header ë¼ëŠ” ê³³ì— ë‹´ì•„ì„œ ìš”ì²­**`ì„ ë³´ë‚´ë©´,

ë°±ì—”ë“œì—ì„œëŠ” ì´ `**token ë§Œìœ¼ë¡œ ë¡œê·¸ì¸ ì—¬ë¶€ ì‹ë³„ / ì–´ë–¤ ìœ ì €ì¸ì§€ ì‹ë³„**`ì„ í•  ìˆ˜ ìˆê²Œ ë˜ëŠ” ê²ƒì´ë‹¤


### 3) router êµ¬í˜„

![](https://velog.velcdn.com/images/jhs000123/post/cf2d09fa-5a3c-40d6-82c0-18bffc106c1d/image.png)

```jsx
import { BrowserRouter, Link, Route, Routes } from 'react-router-dom';
import Login from './components/Login';
import Register from './components/Register';
import Posts from './components/Posts';

function App() {
  return (
    <BrowserRouter>
      <Link to="/login">Login</Link> |
      <Link to="/post">Post</Link> |
      <Link to="/register">Register</Link>
      <Routes>
        <Route path="/login" element={<Login/>}/>
        <Route path="/post" element={<Posts/>}/>
        <Route path="/register" element={<Register/>}/>
      </Routes>
    </BrowserRouter>
  );
}

export default App;
```

### 4) íšŒì›ê°€ì… êµ¬í˜„ ( í† í° íˆ¬í‚¤ì— ì €ì¥)
ì•„ë˜ì²˜ëŸ¼ íšŒì›ê°€ì… ì»´í¬ë„ŒíŠ¸ë¥¼ êµ¬í˜„í•œë‹¤.

```jsx
import axios from 'axios'
import React, { useState } from 'react'
import {useNavigate} from 'react-router-dom'

function Register() {
  const [userInput, setUserInput] = useState({email:'', password:''})
  const inputChangeHandler = (e) => {
    const { name, value } = e.target
    setUserInput({...userInput, [name]:value})
  }

  const doSignup = async () => {
    try {
        const response = await axios.post('http://localhost:8000/register', userInput)
        console.log(response.data)
    } catch (e) {
        console.log('error')
    }
  }

  return (
    <div>
        Register
        <input onChange={inputChangeHandler} name="email"></input>
        <input onChange={inputChangeHandler} name="password" type="password"></input>
        <button onClick={doSignup}>íšŒì›ê°€ì…</button>
    </div>
  )
}

export default Register
```
 response.data ì— accessToken ì´ ë³´ì…ë‹ˆë‹¤! ì´ì œ ì´ê±¸ ì¿ í‚¤ë¡œ ì €ì¥í•œë‹¤. ì¿ í‚¤ë¡œ ì €ì¥ì„ í•´ë†“ìœ¼ë©´, ìœ ì €ê°€ ìƒˆë¡œê³ ì¹¨ì„ í•´ë„, ì›¹ë¸Œë¼ìš°ì €ë¥¼ ì¢…ë£Œí•œ í›„ì— ë‹¤ì‹œ í™ˆí˜ì´ì§€ì— ì ‘ì†ì„ í•´ë„, ê³„ì† token ì´ ì €ì¥ë˜ì–´ìˆê¸° ë•Œë¬¸ì— ì–¸ì œë“ ì§€ ë¡œê·¸ì¸ì´ ë˜ì–´ìˆê²Œ ëœë‹¤.
 
> yarn add react-cookie

ê·¸ë¦¬ê³  ì¿ ê¸°ì™€ ê´€ë ¨ëœ ì„¤ì •ì„ ì¶”ê°€í•œë‹¤

```jsx
import axios from 'axios'
import React, { useState } from 'react'
import {useCookies} from 'react-cookie';
import {useNavigate} from 'react-router-dom'

function Register() {
  const [userInput, setUserInput] = useState({email:'', password:''})
  const inputChangeHandler = (e) => {
    const { name, value } = e.target
    setUserInput({...userInput, [name]:value})
  }
  const [cookies, setCookie, removeCookie] = useCookies()
  const navigate = useNavigate()

  const doSignup = async () => {
    try {
        const response = await axios.post('http://localhost:8000/register', userInput)
        setCookie('accessToken', response.data['accessToken'], {path:'/'})
        // ë°±ì—”ë“œê°€ ì§„ì§œë¼ë©´ userId ì¿ í‚¤ì— í•„ìš”ì—†ìŒ, ì–´ì°¨í”¼ accessToken ì— ë‹´ê²¨ìˆìŒ
        setCookie('userId', response.data['user']['id'], {path:'/'})
        navigate('/post')
    } catch (e) {
        console.log('error')
    }
  }

  return (
    <div>
        Register
        <input onChange={inputChangeHandler} name="email"></input>
        <input onChange={inputChangeHandler} name="password" type="password"></input>
        <button onClick={doSignup}>íšŒì›ê°€ì…</button>
    </div>
  )
}

export default Register
```

ì´ì œ inputì— ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ê³  íšŒì›ê°€ì… ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ posts í˜ì´ì§€ë¡œ ì´ë™í•˜ê²Œ ëœë‹¤.

![](https://velog.velcdn.com/images/jhs000123/post/b814951a-adfb-4a1d-b395-130669d79513/image.png)


### 5) ë¡œê·¸ì¸ êµ¬í˜„í•˜ê¸°

íšŒì›ê°€ì…ê³¼ ë¹„ìŠ·í•œ ëŠë‚Œìœ¼ë¡œ êµ¬í˜„í•˜ë©´ ëœë‹¤.

```jsx
import axios from 'axios'
import React, { useState } from 'react'
import {useCookies} from 'react-cookie';
import {useNavigate} from 'react-router-dom'

function Login() {
  const [userInput, setUserInput] = useState({email:'', password:''})
  const inputChangeHandler = (e) => {
    const { name, value } = e.target
    setUserInput({...userInput, [name]:value})
  }
  const [cookies, setCookie, removeCookie] = useCookies()
  const navigate = useNavigate()

  const doLogin = async () => {
    try {
      const response = await axios.post('http://localhost:8000/login', userInput)
      setCookie('accessToken', response.data['accessToken'], {path:'/'})
      // ë°±ì—”ë“œê°€ ì§„ì§œë¼ë©´ userId ì¿ í‚¤ì— í•„ìš”ì—†ìŒ, ì–´ì°¨í”¼ accessToken ì— ë‹´ê²¨ìˆìŒ
      setCookie('userId', response.data['user']['id'], {path:'/'})
      navigate('/post')
    } catch (e) {
      console.log('error')
    }
  }

  return (
    <div>
        Login
        <input onChange={inputChangeHandler} name="email"></input>
        <input onChange={inputChangeHandler} name="password" type="password"></input>
        <button onClick={doLogin}>ë¡œê·¸ì¸</button>
    </div>
  )
}

export default Login
```

ê·¸ëŸ¼ì´ì œ íšŒì›ê°€ì… í–ˆë˜ ì´ë©”ì¼ê³¼ ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•˜ë©´ ë°”ë¡œ posts ë¡œ ì´ë™í•˜ê²Œ ëœë‹¤.

### 6) í† í°ì„ ë¶ˆëŸ¬ì™€ì„œ ìš”ì²­ë³´ë‚´ê¸°

í† í°ì„ ë¶ˆëŸ¬ì˜¤ëŠ”ê±´ cookies ì—ì„œ ë¶ˆëŸ¬ì˜¤ë©´ëœë‹¤.

ê·¸ë ‡ê²Œ í•˜ê³  ì•„ë˜ì™€ ê°™ì´ axios ìš”ì²­ì„ ë³´ë‚¼ë•Œ 2ë²ˆì§¸ ì¸ìë¡œ headersë¥¼ ì¶”ê°€í•´ì£¼ë©´, ìš”ì²­ì„ ë³´ë‚¼ë•Œ tookenì´ í¬í•¨ë˜ì–´ í•¨ê»˜ ì „ì†¡ëœë‹¤.


### 7) ë‚´ê°€ ì“´ ê¸€ë§Œ ìˆ˜ì •/ì‚­ì œê°€ ê°€ëŠ¥í•˜ë„ë¡ í•˜ê¸°



## ì‹¤ì œ ë°±ì—”ë“œì™€ í†µì‹ 

### 1) redux ì„¤ì •

> yarn create vite (ì•±ëª…) --template react

redux ê´€ë ¨ ëª¨ë“ˆ ì„¤ì¹˜

> yarn add @reduxjs/toolkit react-redux axios react-cookie

- axios ì„¤ì •

`.env`
```
VITE_SERVER_URL='http://localhost:3000/'
```

`apis/axios.js`

```jsx
import axios from 'axios';
import { getCookie } from '../utils/cookies';

const getAxiosInstance = (url) => {
  const instance = axios.create({
    baseURL: url,
    headers: { // í•„ìš”í•œ ê²½ìš° header ë„ ëª…ì‹œ
      'Content-type': 'application/json',
    },
    withCredentials: true // ë°±ì—”ë“œì—ì„œ ì¿ í‚¤ë¥¼ ì„¤ì •í•´ì¤„ ìˆ˜ ìˆë„ë¡ ëª…ì‹œ
  });
  instance.defaults.timeout = 3000;
  // token ì˜ ê²½ìš° ìš”ì²­ì„ ë³´ë‚¼ ë•Œë§ˆë‹¤ í˜„ì¬ í† í° ê°’ì„ ê°€ì ¸ì˜¤ë„ë¡ ì‘ì„±
  // (create í• ë•Œ ë„£ì–´ì¤„ ê²½ìš° ê³ ì •ê°’ìœ¼ë¡œ ë“¤ì–´ê°€ê²Œ ë˜ë¯€ë¡œ, ì•„ë˜ì²˜ëŸ¼ ì‘ì„±í•˜ëŠ” ë°©ì‹ì´ íƒ€ë‹¹í•¨)
  instance.interceptors.request.use(
    (request) => {
      const token = getCookie('accessToken')
      if (token) request.headers['Authorization'] = `Bearer ${token}`
      return request
    },
    (error) => {
      console.log(error)
      return Promise.reject(error)
    }
  )
  return instance
}

export const axiosInstance = getAxiosInstance(import.meta.env.VITE_SERVER_URL)
```

ë¡œê·¸ì¸, íšŒì›ê°€ì…ì´ êµ¬í˜„ëœ ìƒíƒœë¼ë©´, ìš”ì²­ì„ ë³´ë‚¼ ë•Œ í† í°ê°’ë„ í•¨ê»˜ ë³´ë‚´ì£¼ì–´ì•¼ í•©ë‹ˆë‹¤. (ê·¸ë ‡ê²Œ í•´ì•¼ë§Œ ë°±ì—”ë“œì—ì„œ ì¸ì¦ ì—¬ë¶€ë¥¼ í™•ì¸í•  ìˆ˜ ìˆë‹¤.)

ê·¸ë ‡ê¸° ë•Œë¬¸ì— **instance ë¥¼ ë§Œë“¤ë©´ì„œ, ì¸í„°ì…‰í„° í˜•íƒœë¡œ ìš”ì²­ì„ ë³´ë‚¼ ë•Œë§ˆë‹¤ ì¿ í‚¤ì— ì €ì¥ëœ í† í°ì„ ê°€ì ¸ì™€ì„œ ë³´ë‚´ë„ë¡ ì‘ì„±ì„ í•´ì£¼ê² ìŠµë‹ˆë‹¤. (ë˜í•œ withCredentials: true ë¡œ ì„¤ì •í•´ì„œ ë°±ì—”ë“œì—ì„œ ì¿ í‚¤ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.)**

ì•ìœ¼ë¡œëŠ” ìœ„ì—ì„œ ì‘ì„±í•œ `axiosInstance` ë¥¼ í™œìš©í•´ì„œ ìš”ì²­ì„ ë³´ë‚¼ ì˜ˆì •ì´ë‹¤.

- redux slice ë° store ì„¤ì •

`store/slices/postSlice.js`
```js
import { createAsyncThunk } from '@reduxjs/toolkit'
import { axiosInstance } from './../../apis/axios'

// ì´ˆê¸°ê°’
const initialState = {
    entities: [],
    loading: false,
}

// async thunk ìƒì„±
// rejectWithValueë¥¼ í†µí•´ì„œ ì—ëŸ¬ ì²˜ë¦¬

export const getPosts = createAsyncThunk('posts/getPosts', async (_, { rejectWithValue }) => {
    try {
        const response = await axiosInstance.get('api/posts')
        return response.data
    } catch (err) {
        return rejectWithValue(err.response.data)
    }
})

export const getPost = createAsyncThunk('posts/getPost', async (postId, { rejectWithValue }) => {
    try {
        const response = await axiosInstance.get(`api/posts/${postId}`)
        return response.data
    } catch (err) {
        return rejectWithValue(err.response.data)
    }
})

export const createPost = createAsyncThunk('posts/createPost', async (post, { rejectWithValue }) => {
    try {
        const response = await axiosInstance.post(`api/posts`, post)
        return response.data
    } catch (err) {
        return rejectWithValue(err.response.data)
    }
})

export const postSlice = createSlice({
    name: 'posts',
    initialState,
    reducers: {},
    extraReducers: {
        [getPosts.pending]: (state) => {
            state.loading = true
        },
        [getPosts.fulfilled]: (state, action) => {
            state.loading = false
            state.entities = action.payload
        },
        [getPosts.rejected]: (state) => {
            state.loading = false
        },
        [getPost.pending]: (state) => {
            state.loading = true
        },
        [getPost.fulfilled]: (state, action) => {
            state.loading = false
            if (state.entities.find((entity) => entity, id === action.payload.id)) {
                state.entites = state.entites.map((entity) => (entity.id === action.payload.id ? action.payload : entity))
            } else {
                state.entites = [...state.entites, action.payload]
            }
        },
        [getPost.rejected]: (state) => {
            state.loading = false
        },
        [createPost.pending]: (state) => {
            state.loading = true
        },
        [createPost.fulfilled]: (state, action) => {
            state.loading = false
            state.entities = [...state.entities, action.payload]
        },
        [createPost.rejected]: (state) => {
            state.loading = false
        },
    },
})

export default postSlice.reducer

```

`store/slice/authSlice.js`
```js
import { createSlice, createAsyncThunk } from '@reduxjs/toolkit'
import { axiosInstance } from '../../apis/axios'
import { setCookie } from '../../utils/cookies'

const initialState = {
    loading: false,
    userInfo: {},
    isAuthenticated: 'PENDING',
}

export const login = createAsyncThunk('auth/login', async (user, { rejectWithValue }) => {
    try {
        const response = await axiosInstance.post('api/auth/login', user)
        return response.data
    } catch (err) {
        return rejectWithValue(err.response.data)
    }
})
export const register = createAsyncThunk('auth/register', async (user, { rejectWithValue }) => {
    try {
        const response = await axiosInstance.post('api/auth/register', user)
        return response.data
    } catch (err) {
        return rejectWithValue(err.response.data)
    }
})
export const verify = createAsyncThunk('auth/verify', async (_, { rejectWithValue }) => {
    try {
        const response = await axiosInstance.get('api/auth/verify')
        return response.data
    } catch (err) {
        return rejectWithValue(err.response.data)
    }
})

export const authSlice = createSlice({
    name: 'auth',
    initialState,
    reducers: {},
    extraReducers: {
        [login.pending]: (state) => {
            state.loading = true
            // cookie ì™€ í•¨ê»˜ isAuthenticated ê°’ì„ í†µí•´ì„œ ìœ ì €ì˜ ì¸ì¦ ì—¬ë¶€ë¥¼ íŒë³„
            // cookie ì— ìœ íš¨í•˜ì§€ ì•Šì€ í† í°ì´ ë“¤ì–´ê°€ìˆëŠ”ë°ë„ ì¸ì¦ë˜ì—ˆë‹¤ê³  íŒë‹¨í•˜ë©´ ì•ˆë˜ë¯€ë¡œ,
            // verify ìš”ì²­ ë“±ì„ í™œìš©í•´ì„œ ìœ íš¨í•œ í† í°ì¸ì§€ ì—¬ë¶€ë¥¼ íŒë‹¨í•˜ê³  ì¸ì¦ ì—¬ë¶€ë¥¼ íŒë‹¨
            state.isAuthenticated = 'PENDING'
        },
        [login.fulfilled]: (state, action) => {
            // asyncthunk í•¨ìˆ˜ ì•ˆì—ì„œ if ë¬¸ì„ í†µí•´ì„œ setCookie í•´ë„ ë¬´ë°©
            setCookie('accessToken', action.payload.accessToken, { path: '/', maxAge: action.payload.exp - action.payload.iat })
            state.loading = false
            // nav ë°”ì— í‘œì‹œë¥¼ ìœ„í•´ì„œ ì €ì¥
            state.userInfo = { userId: action.payload.id, username: action.payload.username }
            state.isAuthenticated = 'SUCCESS'
        },
        [login.rejected]: (state) => {
            state.loading = false
            state.isAuthenticated = 'FAILED'
        },
        [register.pending]: (state) => {
            state.loading = true
            state.isAuthenticated = 'PENDING'
        },
        [register.fulfilled]: (state, action) => {
            setCookie('accessToken', action.payload.accessToken, { path: '/', maxAge: action.payload.exp - action.payload.iat })
            state.loading = false
            state.userInfo = { userId: action.payload.id, username: action.payload.username }
            state.isAuthenticated = 'SUCCESS'
        },
        [register.rejected]: (state) => {
            state.loading = false
            state.isAuthenticated = 'FAILED'
        },
        [verify.pending]: (state) => {
            state.loading = true
            state.isAuthenticated = 'PENDING'
        },
        [verify.fulfilled]: (state, action) => {
            state.loading = false
            state.userInfo = { userId: action.payload.id, username: action.payload.username }
            state.isAuthenticated = 'SUCCESS'
        },
        [verify.rejected]: (state) => {
            state.loading = false
            state.userInfo = {}
            state.isAuthenticated = 'FAILED'
        },
    },
})

export default authSlice.reducer

```

`utils/cookies.js`
```js
import { Cookies } from 'react-cookie'

const cookies = new Cookies() // ì¿ í‚¤ ê°ì²´ë¥¼ ìƒì„±í•˜ê³ ,

export const getCookie = (name) => {
    try {
        return cookies.get(name) // get ì„ í•˜ë©´ name ì„ ê¸°ì¤€ìœ¼ë¡œ ì¿ í‚¤ ê°’ì„ ê°€ì ¸ì˜µë‹ˆë‹¤.
    } catch (error) {
        console.error(error)
    }
}

export const setCookie = (name, value, option) => {
    try {
        cookies.set(name, value, { ...option }) // set ì„ í•˜ë©´ name = value í˜•íƒœë¡œ ì¿ í‚¤ë¥¼ ì„¤ì •í•  ìˆ˜ ìˆìŠµë‹ˆë‹¤.
    } catch (error) {
        console.error(error)
    }
}

export const removeCookie = (name, option) => {
    try {
        cookies.remove(name, { ...option }) // remove í•˜ë©´ í•´ë‹¹ name ì¿ í‚¤ë¥¼ ì‚­ì œí•©ë‹ˆë‹¤.
    } catch (error) {
        console.error(error)
    }
}

```

`store/index.js`
```js
import { combineReducers, configureStore } from '@reduxjs/toolkit'
import { authSlice } from './slices/authSlice'
import postReducer from './slices/postSlice'
import authReducer from './slices/authSlice'
import { postSlice } from './slices/postSlice'

const rootReducer = combineReducers({
    [authSlice.name]: authReducer,
    [postSlice.name]: postReducer,
})

const store = configureStore({
    reducer: rootReducer,
    middleware: (getDefaultMiddleware) => getDefaultMiddleware(),
})

export default store

```
`app.jsx`
```jsx
import './App.css'
import { Provider} from 'react-redux'
import store from './store/index'


function App() {
    return (
        <Provider store={store}>
           <></>
        </Provider>
    )
}

export default App

```

### 3) component ìƒì„±í•˜ê¸°
ì‘ì€ ë‹¨ìœ„ë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ìƒì„±í•˜ê³ , í•´ë‹¹ ì»´í¬ë„ŒíŠ¸ë¥¼ ì´ìš©í•´ì„œ í˜ì´ì§€ë¥¼ êµ¬ì„±í•œë‹¤.

- common -> layout, nav ì»´í¬ë„ŒíŠ¸
- login -> loginform ì»´í¬ë„ŒíŠ¸ (formik,tup í™œìš©)
- posts -> postform, postitem, postlist ì»´í¬ë„ŒíŠ¸
- register -> registerform ì»´í¬ë„ŒíŠ¸

- common ì»´í¬ë„ŒíŠ¸

`common/Layout/index.jsx`

```jsx
import React from 'react'
import { useSelector } from 'react-redux'
import { Outlet } from 'react-router-dom'
import Nav from '../Nav'

function Layout() {
    const username = useSelector((state) => state.auth.userInfo.username)

    return (
        <>
            {username ? <p>{username}ë‹˜ ì•ˆë…•í•˜ì„¸ìš”</p> : null}
            <Nav />
            <Outlet />
            <footer>í‘¸í„°ì…ë‹ˆë‹¤</footer>
        </>
    )
}

export default Layout

```

`common/Nav/index.jsx`

```jsx
import React from 'react'
import { NavLink } from 'react-router-dom'

function Nav() {
    return (
        <nav>
            <NavLink style={({ isActive }) => ({ color: isActive ? 'red' : 'black' })} to="/posts">
                Posts
            </NavLink>{' '}
            <NavLink style={({ isActive }) => ({ color: isActive ? 'red' : 'black' })} to="/login">
                Login
            </NavLink>{' '}
            <NavLink style={({ isActive }) => ({ color: isActive ? 'red' : 'black' })} to="/register">
                Register
            </NavLink>
        </nav>
    )
}

export default Nav

```

- login ì»´í¬ë„ŒíŠ¸

`login/LoginForm/index.jsx`

```jsx
import React, { useState } from 'react'
import { useFormik } from 'formik'
import * as Yup from 'yup'

function LoginForm({ onSubmit }) {
    const formik = useFormik({
        initialValues: {
            username: '',
            password: '',
        },
        validationSchema: Yup.object({
            username: Yup.string().required('ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'),
            password: Yup.string().required('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'),
        }),
        onSubmit: (values) => {
            onSubmit(values) //
        },
    })
    // getFiledProps ë¥¼ í™œìš©í•˜ë©´ value, onChange, onBllur, name ë“±ì˜ propsë“¤ì´ ëª¨ë‘ íƒœê·¸ì— ë“¤ì–´ê°€ê²Œëœë‹¤.

    return (
        <form onSubmit={formik.handleSubmit}>
            <input name="username" {...formik.getFieldProps('username')} />
            {formik.errors.username ? <p>{formik.errors.username}</p> : null}
            <input name="password" {...formik.getFieldProps('password')} />
            {formik.errors.password ? <p>{formik.errors.password}</p> : null}
            <button type="submit">ì œì¶œí•˜ê¸°</button>
        </form>
    )
}

export default LoginForm
```
`Yup`ì€ ìœ íš¨ì„± ê²€ì¦ì„ ìœ„í•œ ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë©°, `Formik`ëŠ” ë¦¬ì•¡íŠ¸ì—ì„œ formì„ ë”ìš± ì›í™œí•˜ê²Œ ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤. ìœ„ì²˜ëŸ¼ `Yup`ê°ì²´ë¥¼ ë§Œë“¤ì–´ì„œ `Formik`ì˜ `validationSchema`ë¡œ í• ë‹¹í•˜ë©´, í•´ë‹¹ ê°ì²´ key ì™€ ì¼ì¹˜í•˜ëŠ” nameì„ ê°€ì§„ inputì— ëŒ€í•´ì„œ ìœ íš¨ì„± ê²€ì¦ì„ í•˜ê²Œ ëœë‹¤.

ìš°ì„  string,number,email,url,date,required,min,max ë“±ì˜ ì†ì„± ì§€ì •ì´ ê°€ëŠ¥í•˜ë‹¤.

ìì„¸í•œ ì‚¬í•­ì€ https://github.com/jquense/yup#yup ì´ê³³ì„ ì°¸ì¡°

- register ì»´í¬ë„ŒíŠ¸
`register/RegisterForm/index.jsx`
```jsx
import { useFormik } from 'formik'
import React from 'react'

function RegisterForm() {
    const formik = useFormik({
        initialValues: {
            email: '',
            username: '',
            password: '',
        },
        validationSchema: Yup.object({
            email: Yup.string().email('ì˜¬ë°”ë¥¸ í˜•ì‹ìœ¼ë¡œ ì…ë ¥í•´ì£¼ì„¸ìš”').required('ì´ë©”ì¼ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'),
            username: Yup.string().required('ì•„ì´ë””ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'),
            password: Yup.string().min(8, 'ìµœì†Œ 8ì ì´ìƒì€ ì‘ì„±í•´ì£¼ì„¸ìš”').required('ë¹„ë°€ë²ˆí˜¸ë¥¼ ì…ë ¥í•´ì£¼ì„¸ìš”'),
        }),
        onSubmit: (values) => {
            onSubmit(values)
        },
    })
    return (
        <form onSubmit={formik.handleSubmit}>
            <input name="email" {...formik.getFieldProps('email')} />
            {formik.errors.email ? <p>{formik.errors.email}</p> : null}
            <input name="username" {...formik.getFieldProps('username')} />
            {formik.errors.username ? <p>{formik.errors.username}</p> : null}
            <input name="password" {...formik.getFieldProps('password')} />
            {formik.errors.password ? <p>{formik.errors.password}</p> : null}
            <button type="submit">ì œì¶œí•˜ê¸°</button>
        </form>
    )
}

export default RegisterForm
```

- posts ì»´í¬ë„ŒíŠ¸ 
`post/PostList/index.jsx`
```jsx
import React from 'react'
import { Link } from 'react-router-dom'

function PostList({ posts }) {
    if (!posts) return <p>Not Found</p>
    return (
        <div>
            {posts.map((post) => {
                ;<p key={post.id}>
                    <Link to={`/posts/${post.id}`}>{post.title}</Link>
                </p>
            })}
        </div>
    )
}

export default PostList


```

`posts/PostItem/index.jsx`
```jsx
import React from 'react'

function PostItem({ post }) {
    if (!post) return <p>Not Found</p>
    return (
        <div>
            <h3>{post.title}</h3>
            <p>{post.body}</p>
        </div>
    )
}

export default PostItem

```

`Posts/PostForm/index.jsx`
```jsx
import { useFormik } from 'formik'
import React from 'react'
import * as Yup from 'yup'

function PostForm({ onSubmit }) {
    const formik = useFormik({
        initialValues: {
            title: '',
            body: '',
        },
        validationSchema: Yup.object({
            title: Yup.string().min(10, 'ìµœì†Œ 10ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”').required('ì œëª©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'),
            body: Yup.string().min(10, 'ìµœì†Œ 10ì ì´ìƒ ì‘ì„±í•´ì£¼ì„¸ìš”').required('ë‚´ìš©ì„ ì…ë ¥í•´ì£¼ì„¸ìš”'),
        }),
        onSubmit: (values) => {
            onSubmit(values)
        },
    })

    return (
        <form onSubmit={formik.handleSubmit}>
            <input name="title" {...formik.getFieldProps('title')} />
            {formik.errors.title ? <p>{formik.errors.title}</p> : null}
            <input name="body" {...formik.getFieldProps('body')} />
            {formik.errors.body ? <p>{formik.errors.body}</p> : null}
            <button type="submit">ì œì¶œí•˜ê¸°</button>
        </form>
    )
}

export default PostForm

```

### 4) í˜ì´ì§€ ì„¤ì •í•˜ê¸°

pageì™€ routeëŠ” ì•„ë˜ì™€ ê°™ì´ êµ¬ì„±í•œë‹¤.

- /login -> ë¡œê·¸ì¸ í˜ì´ì§€
- /registre -> íšŒì›ê°€ì… í˜ì´ì§€
- /posts -> ê¸€ ë¦¬ìŠ¤íŠ¸
- /posts/:id -> ê¸€ í•˜ë‚˜
- /posts/new -> ê¸€ ì‘ì„±

`pages/Login/index.jsx`
```jsx
import React from 'react'
import { useDispatch } from 'react-redux'
import LoginForm from '../../components/login/LoginForm'
import { login } from './../../store/slices/authSlice'

function Login() {
    const dispatch = useDispatch()
    const onSubmit = (user) => {
        dispatch(login(user))
    }
    return (
        <div>
            <LoginForm onSubmit={onSubmit} />
        </div>
    )
}

export default Login

```
`pages/Register/index.jsx`
```jsx
import React from 'react'
import { useDispatch } from 'react-redux'
import RegisterForm from '../../components/register/RegisterForm'
import { register } from '../../store/slices/authSlice'

function Register() {
    const dispatch = useDispatch()
    const onSubmit = (user) => {
        dispatch(register(user))
    }
    return <RegisterForm onSubmit={onSubmit} />
}

export default Register

```

`pages/Posts/index.jsx`
```jsx
import React from 'react'
import { useEffect } from 'react'
import { useDispatch, useSelector } from 'react-redux'
import PostList from '../../components/posts/PostList'
import { getPosts } from './../../store/slices/postSlice'

function Posts() {
    const dispatch = useDispatch()
    const { entities: posts, loading } = useSelector((state) => state.posts)

    useEffect(() => {
        dispatch(getPosts())
    }, [])
    if (loading) return <p>Loading</p>
    return (
        <div>
            <PostList posts={posts} />
        </div>
    )
}

export default Posts


```

`pages/Posts/PostDetail/index.jsx`

```jsx
import React from 'react'
import { useEffect } from 'react'
import { useDispatch, useSelector } from 'react-redux'
import { useNavigate, useParams } from 'react-router-dom'
import PostItem from '../../../components/posts/PostItem'
import { getPosts } from '../../../store/slices/postSlice'

function PostDetail() {
    const { postId } = useParams()
    const dispatch = useDispatch()
    const navigate = useNavigate()
    const { post, loading } = useSelector((state) => ({
        post: state.posts.entities.find((entity) => entity.id === Number(postId)),
        loading: state.posts.loading,
    }))
    useEffect(() => {
        if (!post) dispatch(getPosts(postId))
    }, [])
    if (loading) return <p>Loading...</p>
    return (
        <div>
            <PostItem post={post} />
            <button onClick={() => navigate(-1)}>ëª©ë¡ìœ¼ë¡œ</button>
        </div>
    )
}

export default PostDetail


```

`pages/Posts/PostCreate/index.jsx`
```jsx
import React from 'react'
import { useDispatch } from 'react-redux'
import PostForm from '../../../components/Posts/PostForm'
import { createPost } from '../../../store/slices/postSlice'

function PostCreate() {
    const dispatch = useDispatch()
    const onSubmit = (post) => {
        dispatch(createPost(post))
    }

    return (
        <div>
            <PostForm onSubmit={onSubmit} />
        </div>
    )
}

export default PostCreate

```

`Routes/router`

```jsx
import { Routes, Route } from 'react-router-dom'
import PostCreate from '../pages/Posts/PostCreate'

function Router() {
    return (
        <Routes>
            <Route path="/" element={<Layout />}>
                <Route path="posts" element={<Posts />} />
                <Route path="posts/:postId" element={<PostDetail />} />
                <Route path="posts/new" element={<PostCreate />} />
                <Route path="login" element={<Login />} />
                <Route path="register" element={<Register />} />
                <Route path="*" element={<p>not Found</p>} />
            </Route>
        </Routes>
    )
}

export default Router

```

![](https://velog.velcdn.com/images/jhs000123/post/d30294a3-4b00-4aae-9433-e4eb6afe56d0/image.png)

