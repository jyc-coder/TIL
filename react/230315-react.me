# Redux
ìƒíƒœ ê´€ë¦¬ ë¼ì´ë¸ŒëŸ¬ë¦¬

## Reduxì˜ êµ¬ì¡°


### 1) flux íŒ¨í„´

- MVCíŒ¨í„´

FluxíŒ¨í„´ì´ ë“±ì¥í•˜ê¸° ì „ì— ëŒ€ë¶€ë¶„ì˜ ì•±ì´ ì‚¬ìš©í•˜ê³  ìˆë˜ ì†Œí”„íŠ¸ì›¨ì–´ ë””ìì¸ íŒ¨í„´ì´ë‹¤.

model: ë°ì´í„°ë¥¼ ë³´ê´€
Controller : ë°ì´í„°ì— ëŒ€í•œ ìˆ˜ì •, ì¡°íšŒ
View: ë°ì´í„°ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ì—­í• 

ì´ë ‡ê²Œ ë‚˜ëˆ„ë©´ Controller ë¥¼ í†µí•´ì„œ Modelì„ ìˆ˜ì •í•˜ê³  ê·¸ ë°ì´í„°ë¥¼ Viewì— ë³´ì—¬ì£¼ê²Œ ëœë‹¤.

ì´ íŒ¨í„´ì€ Viewì—ì„œ ì‚¬ìš©ìì™€ì˜ ìƒí˜¸ì‘ìš©ì„ í†µí•´ Modelì„ ìˆ˜ì •í• ìˆ˜ ìˆë„ë¡ í•˜ê³  ìˆë‹¤.

ë§Œì•½ Model ê³¼ Viewê°€ ë§ì•„ì§€ë©´  í•˜ë‚˜ì˜ Modelìˆ˜ì •ì— ë”°ë¼ ì—¬ëŸ¬ Viewê°€ ìˆ˜ì •ë˜ê±°ë‚˜ Viewì—ì„œì˜ ìƒí˜¸ì‘ìš©ì— ë”°ë¼ì„œ ì—¬ëŸ¬ Model ì´ ìˆ˜ì •ë  ìˆ˜ ìˆë‹¤.

> ì •í™•ì´ ì–´ë–¤ ë°ì´í„°ê°€ ì–´ë–¤ Viewë¥¼ í†µí•´ì„œ ìˆ˜ì •ì´ ë˜ê³ , ì–´ë–¤ Viewê°€ ì •í™•íˆ ì–´ë–¤ ëª¨ë¸ë¡œë¶€í„° ë°ì´í„°ë¥¼ ë°›ëŠ”ì§€ ê·¸ íë¦„ì„ ì¶”ì í•˜ëŠ” ê²ƒì´ ë³µì¡í•´ì§„ë‹¤.

- FlexíŒ¨í„´

ì´ëŸ° ë³µì¡ì„±ì„ í•´ê²° í•˜ê³ ì ë“±ì¥í•œ ê²ƒì´ ë°”ë¡œ Flux íŒ¨í„´ì´ë‹¤.

- Action: ë°ì´í„°ì— ëŒ€í•´ì„œ ì €ì˜¤í•™íˆ ì–´ë–¤ ìƒíƒœ ë³€í™”ë¥¼ í• ì§€ ì§€ì •

- Dispatcher: Storeì— Actionì„ ì „ë‹¬í•˜ëŠ” ì—­í• (ë™ê¸°ì ìœ¼ë¡œ ì‹¤í–‰ë˜ì–´ ë°ì´í„° íë¦„ì„ ê´€ë¦¬)

- Store : Dispatcher ë¡œë¶€í„° actionì„ ë°›ì•„ì„œ ë°ì´í„°ì˜ ìƒíƒœë¥¼ ë³€ê²½í•˜ê³  ë³´ê´€(ìƒíƒœê°€ ë³€ê²½ë˜ë©´ ë³€ê²½ë˜ì—ˆë‹¤ê³  ì•Œë¦¼)

- View : ë°ì´í„°ë¥¼ í™”ë©´ì— ë³´ì—¬ì£¼ëŠ” ì—­í•  (ë°ì´í„°ë¥¼ ìì‹ ì»´í¬ë„ŒíŠ¸ ë“±ìœ¼ë¡œ ë³´ë‚´ì£¼ëŠ” ì»¨íŠ¸ë¡¤ëŸ¬ì˜ ì—­í• ë„ í•¨ê»˜í•¨)


`redux`ëŠ” ì´ FluxíŒ¨í„´ì„ ê¸°ë°˜ìœ¼ë¡œ ë§Œë“¤ì–´ì ¸ìˆëŠ”ë°, íŠ¹ì§•ì´ì ì°¨ì´ì ì€ ë‹¤ìŒê³¼ ê°™ë‹¤.

- storeëŠ” ë°ì´í„°ì˜ ë³´ê´€ ì—­í• ë§Œ ë‹´ë‹¹
- reducerê°€ ë°ì´í„° ê°±ì‹  ì—­í• ì„ ë‹´ë‹¹í•¨
- dispatcherê°€ ì—†ìŒ (reducerê°€ ëŒ€ì‹  actionsì— ë”°ë¥¸ ì „ë‹¬ì„ ë‹´ë‹¹í•¨)


### 2) Reduxì˜ êµ¬ì¡°

reduxë¥¼ ì‚¬ìš©í•´ì„œ ì¹´ìš´í„°ë¥¼ ë§Œë“ ë‹¤

- Action Type ì •ì˜

typeì„ ë³€ìˆ˜ í˜•íƒœë¡œ ë¯¸ë¦¬ ë§Œë“¤ì–´ ë†“ëŠ” ì´ìœ ëŠ”, exportë¥¼ í•´ì„œ ë‹¤ë¥¸ íŒŒì¼ì—ì„œ í¸í•˜ê²Œ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ í•˜ê¸° ìœ„í•¨ì´ë‹¤.
í˜¹ì‹œë‚˜ ìˆì„ ì˜¤íƒ€ ë“±ì„ ë°©ì§€í•˜ê¸° ìœ„í•œ ì˜ë„ë„ ì¡´ì¬

```jsx
export const INC_COUNT = "INC_COUNT";
export const DEC_COUNT = "DEC_COUNT";
```


- Action ìƒì„± í•¨ìˆ˜

ì›ì¹™ì €ê·¸ë¡œ í•­ìƒ ì• ì…˜ ê°ì²´ë¥¼ ë¦¬í„´í•´ì•¼í•œë‹¤.
action ê°ì²´ë¥¼ reducerë¡œ ë³´ë‚´ëŠ” í–‰ìœ„ë¥¼ dispatch ë¼ê³  í•œë‹¤. dispatchì— actionê°ì²´ë¥¼ returní•˜ëŠ” í•¨ìˆ˜ë¥¼ ì „ë‹¬í•´ì„œ ì‚¬ìš©í•˜ëŠ” ê²½ìš°ë„ ìˆë‹¤.



```jsx
export function incCount(diff) {
    return {
        type: INC_COUNT,
        payload: {diff},
    }
}

export function decCount(diff) {
    return {
        type: DEC_COUNT,
        payload: {diff},
    }
}
```

- reducer 
stateëŠ” ë¶ˆë³€ì„±ì„ ìœ ì§€í•´ì•¼í•œë‹¤. ë™ì¼í•œ íŒŒë¼ë¯¸í„°ê°€ ë“¤ì–´ì™”ì„ ë•ŒëŠ” ë™ì¼í•œ ê²°ê³¼ë¥¼ ì¶œë ¥í•´ì•¼í•œë‹¤.

reducerëŠ” stateì™€ acctionì„ íŒŒë¼ë¯¸í„°ë¡œ ë°›ëŠ”ë‹¤.

ê·¸ë˜ì„œ í˜„íƒœ ìƒí…Œì—, action ê°ì²´ë¥¼ í† ëŒ€ë¡œ ë³€í™”ë¥¼ ì£¼ê²Œ ëœë‹¤.

```jsx
function counter(state = initialState, action) {
    switch (action.type) {
      case INC_COUNT:
        return state + 1
      case DEC_COUNT:
        return state - 1;
      default:
        return state;
    }
  }
```


- store 
í•˜ë‚˜ì˜ ì•±ì—ëŠ” í•˜ë‚˜ì˜ ìŠ¤í† ì–´ê°€ ìˆë„ë¡ êµ¬ì„±í•˜ëŠ” ê²ƒì´ ê·œì¹™!

ì•ì„œ ë§Œë“  ë¦¬ë“€ì„œì™€ ìƒíƒœë¥¼ ë‹´ì•„ë†“ì€ ê²ƒì„ ë§í•œë‹¤. ì´ storeë¥¼ Providerë¼ëŠ” ê²ƒì„ í†µí•´ ê³µìœ í•¨ìœ¼ë¡œì¨ ,ì–´ë–¤ ì»´í¬ë„ŒíŠ¸ì—ì„œë“  ë¦¬ë“€ì„œì™€ ìƒíƒœë¥¼ ê°€ì ¸ì™€ì„œ ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ ì½”ë“œë¥¼ ì‘ì„±í•œë‹¤.

```jsx
import { legacy_createStore as createStore } from "redux";
import counter from "./reducers/counter";

const store = createStore(counter);

export default store;
```

```jsx
import { Provider } from "react-redux";
import store from './redux';

function App() {
  return (
    <Provider store={store}>
			<Counter />
    </Provider>
  );
}

export default App;
```

### 3) useSelector, useDispatch

- useSelector

redux ë¡œ ê´€ë¦¬ì¤‘ì¸ ìƒíƒœë¥¼ ê°€ì ¸ì˜¤ê¸° ìœ„í•œ Hook
stateì•ˆì— numberë¼ëŠ” ë°ì´í„°ê°€ ìˆë‹¤ë©´, ì•„ë˜ì²˜ëŸ¼ ê°€ì ¸ì˜¬ìˆ˜ ìˆë‹¤.
dispatchë¥¼ í†µí•´ì„œ stateê°€ ë³€í•˜ê²Œ ë˜ë©´, ìë™ìœ¼ë¡œ useSelectorë¥¼ í†µí•´ì„œ ë°›ì•„ì˜¨ stateë„ ë³€í•˜ê²Œ ëœë‹¤.

```jsx
import { useSelector } from 'react-redux'

[Oconst { number } = useSelector(state => state)
```

- useDispatch 

dispatch í•¨ìˆ˜ë¥¼ ì‹¤í–‰í• ìˆ˜ ìˆë„ë¡ í•´ì£¼ëŠ” Hookì´ë‹¤.
ë§Œë“¤ì–´ì§„ ì•¡ì…˜ ê°ì²´ë¥¼ Reducerë¡œ ì „ë‹¬í•˜ëŠ” ê³¼ì •ì„ ìˆ˜í–‰í•´ì£¼ëŠ” Hookì´ë¼ê³  ìƒê°í•˜ë©´ ëœë‹¤.

```jsx
import { useDispatch } from 'react-redux'

const dispatch = useDispatch()

// ì‚¬ìš© ì˜ˆì‹œ
dispatch(incCount(1))
```

### 4) Container Presenter íŒ¨í„´

- ë¦¬ì•¡íŠ¸ ë””ìì¸ íŒ¨í„´ ì¤‘ì˜ í•˜ë‚˜ë¡œ, ê¸°ëŠ¥ê³¼ UIë¥¼ ì»´í¬ë„ŒíŠ¸ ìƒìœ¼ë¡œ ë¶„ë¦¬í•˜ëŠ” ê²ƒì„ ë§í•œë‹¤.
ë°ì´í„°ë¥¼ ì²˜ë¦¬í•˜ê³  ,ë°›ì•„ì˜¤ëŠ” ë¶€ë¶„ì€ `container`ì—ì„œ ë‹´ë‹¹í•˜ê³ , 
ë°ì´í„°ë¥¼ ë³´ì—¬ì£¼ëŠ” ë¶€ë¶„(UI)ëŠ” `presenter`ì—ì„œ ë‹´ë‹¹í•˜ë„ë¡ ë¶„ë¦¬í•˜ëŠ” ê²ƒì´ë‹¤. 


container ì˜ˆì‹œ

presenter ì»´í¬ë„ŒíŠ¸ë¡œ props í˜•íƒœë¡œ ë„˜ê²¨ì£¼ê²Œ ëœë‹¤.
```jsx
import { useDispatch, useSelector } from 'react-redux';
import Counter from '../components/Counter';
import { incCount, decCount } from '../redux/actions/counter';

function CounterContainer() {
    const dispatch = useDispatch();
    const number = useSelector((state) => state.number);

    const onIncrease = () => {
        dispatch(incCount(1));
    }

    const onDecrease = () => {
        dispatch(decCount(1));
    }

    return <Counter number={number} onIncrease={onIncrease} onDecrease={onDecrease} />
}

export default CounterContainer
```

ì•„ë˜ëŠ” presenter ì»´í¬ë„ŒíŠ¸ì˜ ì˜ˆì‹œì´ë‹¤.

container ì»´í¬ë„ŒíŠ¸ì—ì„œ ë„˜ê²¨ì¤€ ê²ƒì„ ë°›ì•„ì„œ uië¥¼ ë§Œë“¤ì–´ì£¼ê²Œëœë‹¤.

```jsx
import React from 'react'

function Counter({number, onIncrease, onDecrease}) {
  return (
    <div>
      <p>{number}</p>
      <button onClick={onIncrease}>+1</button>
      <button onClick={onDecrease}>-1</button>
    </div>
  )
}

export default Counter
```

### 6) ì¹´ìš´í„° ë§Œë“¤ì–´ë³´ê¸°
+1 -1 ê¸°ëŠ¥ì„ ê°€ì§„ ì¹´ìš´í„°ë¥¼ ë§Œë“¤ì–´ë³¸ë‹¤.

![](https://velog.velcdn.com/images/jhs000123/post/98c61ab9-4c01-446e-a27a-abafe3e4e545/image.png)


constants í´ë”ì˜ counter íŒŒì¼

```jsx
export const INC_COUNT = "INC_COUNT";
export const DEC_COUNT = "DEC_COUNT";
```

actions í´ë”ì˜ counter

```jsx
import {INC_COUNT, DEC_COUNT} from '../constants/counter'

export function incCount(diff) {
    return {
        type: INC_COUNT,
        payload: {diff},
    }
}

export function decCount(diff) {
    return {
        type: DEC_COUNT,
        payload: {diff},
    }
}
```

reducers í´ë” ë‚´ë¶€ì— ë¦¬ë“€ì„œ ìƒì„±

```jsx
import { INC_COUNT, DEC_COUNT } from "../constants/counter";

const initialState = {number: 0};

export default function counter(state = initialState, action) {
    switch (action.type) {
      case INC_COUNT:
        return {number: state.number + action.payload.diff}
      case DEC_COUNT:
        return {number: state.number - action.payload.diff};
      default:
        return state;
    }
}
```

store í´ë” ì˜ store ìƒì„±

```jsx
import { legacy_createStore as createStore } from "redux";
import counter from "../reducers/counter";

const store = createStore(counter);

export default store;
```

app.jsx ì—ì„œ Providerë¡œ ì»´í¬ë„ŒíŠ¸ë¥¼ ê°ì‹¸ì£¼ë©´ ì™„ë£Œ
```jsx
import Counter from "./components/Counter";
import { Provider } from 'react-redux';
import store from './store';

function App() {
  return (
    <Provider store={store}>
      <Counter/>
    </Provider>
  );
}

export default App;
```

Container ë‚´ë¶€ì— ê¸°ëŠ¥ì„ êµ¬í˜„í•´ì„œ ì»´í¬ë„ŒíŠ¸ì— propsë¡œ ì „ë‹¬í•œë‹¤.
```jsx
import { useDispatch, useSelector } from 'react-redux';
import Counter from '../components/Counter';
import { incCount, decCount } from '../redux/actions/counter';

function CounterContainer() {
    const dispatch = useDispatch();
    const number = useSelector((state) => state.number);

    const onIncrease = () => {
        dispatch(incCount(1));
    }

    const onDecrease = () => {
        dispatch(decCount(1));
    }

    return <Counter number={number} onIncrease={onIncrease} onDecrease={onDecrease} />
}

export default CounterContainer
```

presenterëŠ” ì•„ë˜ì™€ ê°™ì´ ì‘ì„±

```jsx
import React from 'react'

function Counter({number, onIncrease, onDecrease}) {
  return (
    <div>
      <p>{number}</p>
      <button onClick={onIncrease}>+1</button>
      <button onClick={onDecrease}>-1</button>
    </div>
  )
}

export default Counter
```

ì´ì œ ë§ˆì§€ë§‰ìœ¼ë¡œ CounterContainerë¥¼ App.jsxì—ì„œ í‘œì‹œí•˜ë„ë¡ ë³€ê²½
```jsx
import { Provider } from 'react-redux';
import store from './redux/store/store';
import CounterContainer from "./containers/CounterContainer";

function App() {
  return (
    <Provider store={store}>
      <CounterContainer/>
    </Provider>
  );
}

export default App;
```
### 7) ì¹´ìš´í„° ë§Œë“¤ì–´ë³´ê¸° duckíŒ¨í„´
ì´ì „ì—ëŠ” ì•¡ì…˜íƒ€ì…, ì•¡ì…˜ ìƒì„± í•¨ìˆ˜, ì´ˆê¸°ê°’, ë¦¬ë“€ì„œë¥¼ ë”°ë¡œ ì„ ì–¸í–ˆì§€ë§Œ ì´ë²ˆì—ëŠ” í•˜ë‚˜ì˜ íŒŒì¼ì•ˆì— ì „ë¶€ ì‘ì„±í•œë‹¤.
```jsx
// ì•¡ì…˜ íƒ€ì…
const INC_COUNT = "counter/INC_COUNT";
const DEC_COUNT = "counter/DEC_COUNt";

// ì•¡ì…˜ ìƒì„± í•¨ìˆ˜
export function incCount(diff) {
    return {
        type: INC_COUNT,
        payload: {diff},
    }
}

export function decCount(diff) {
    return {
        type: DEC_COUNT,
        payload: {diff},
    }
}

// ì´ˆê¸°ê°’
const initialState = {number: 0};


// ë¦¬ë“€ì„œ ì„ ì–¸
export default function counter(state = initialState, action) {
    switch (action.type) {
      case INC_COUNT:
        return {
          ...state,
          number: state.number + action.payload.diff
        }
      case DEC_COUNT:
        return {
          ...state,
          number: state.number - action.payload.diff
        };
      default:
        return state;
    }
  }
```
- store ìƒì„±
```jsx
import { legacy_createStore as createStore } from "redux";
import counter from "./counter";

const store = createStore(counter);

export default store;
```
- modulesì—ì„œ storeë¥¼ ê°€ì ¸ì˜¤ë„ë¡ ìˆ˜ì •
```jsx
import { Provider } from 'react-redux';
import store from './modules';
import CounterContainer from "./containers/CounterContainer";

function App() {
  return (
    <Provider store={store}>
      <CounterContainer/>
    </Provider>
  );
}

export default App;
```

- containerì—ì„œ action ìƒì„±í•¨ìˆ˜ë¥¼ ë¶ˆëŸ¬ì˜¤ëŠ” ê²½ë¡œë§Œ ë³€ê²½í•´ì£¼ë©´ ëœë‹¤.
```jsx
import { useDispatch, useSelector } from 'react-redux';
import Counter from '../components/Counter';
import { incCount, decCount } from '../modules/counter';

function CounterContainer() {
    const dispatch = useDispatch();
    const number = useSelector((state) => state.number);

    const onIncrease = () => {
        dispatch(incCount(1));
    }

    const onDecrease = () => {
        dispatch(decCount(1));
    }

    return <Counter number={number} onIncrease={onIncrease} onDecrease={onDecrease} />
}

export default CounterContainer
```
## Redux í™œìš©í•´ë³´ê¸°

### 1) ìœ ì €ì •ë³´ ë¦¬ìŠ¤íŠ¸ ë‹¤ë£¨ê¸°

ìœ ì € ë°ì´í„°ë¥¼ í™œìš©í•´ì„œ ìƒíƒœê´€ë¦¬ë¥¼ ì§„í–‰í•œë‹¤.

ìœ ì € ì •ë³´ë¥¼ ì¶”ê°€ ì œê±°í•˜ëŠ” ê³¼ì •ì„ ë‹¤ë£¬ë‹¤.

```jsx
export const userData = [
    {
      id: 1,
      name: 'Leanne Graham',
      email: 'Sincere@april.biz',
    },
    {
      id: 2,
      name: 'Ervin Howell',
      email: 'Shanna@melissa.tv',
    },
    {
      id: 3,
      name: 'Clementine Bauch',
      email: 'Nathan@yesenia.net',
    },
    {
      id: 4,
      name: 'Patricia Lebsack',
      email: 'Julianne.OConner@kory.org',
    },
    {
      id: 5,
      name: 'Chelsey Dietrich',
      email: 'Lucio_Hettinger@annie.ca',
    },
    {
      id: 6,
      name: 'Mrs. Dennis Schulist',
      email: 'Karley_Dach@jasper.info',
    },
    {
      id: 7,
      name: 'Kurtis Weissnat',
      email: 'Telly.Hoeger@billy.biz',
    },
    {
      id: 8,
      name: 'Nicholas Runolfsdottir V',
      email: 'Sherwood@rosamond.me',
    },
    {
      id: 9,
      name: 'Glenna Reichert',
      email: 'Chaim_McDermott@dana.io',
    },
    {
      id: 10,
      name: 'Clementina DuBuque',
      email: 'Rey.Padberg@karina.biz',
    },
]
```

ducksíŒ¨í„´ìœ¼ë¡œ ì§„í–‰í•œë‹¤.
`modules/user.js`

```jsx
import { userData } from '../constants/userData'

// ì•¡ì…˜ íƒ€ì…
const ADD_USER = 'user/ADD_USER'

// ì•¡ì…˜ ìƒì„± í•¨ìˆ˜
// ë°±ì—”ë“œê°€ ì—†ê¸° ë•Œë¬¸ì— ì´ë ‡ê²Œ ì‘ì„±ë˜ì–´ìˆëŠ” ê²ƒë¿ì´ë©°, ì‹¤ì œ ì„œë¹„ìŠ¤ì˜ ê²½ìš° ì´ ë¶€ë¶„ì´ ì—†ì„ ê²ë‹ˆë‹¤!
// ë°ì´í„°ì˜ id ëŠ” ë°±ì—”ë“œì—ì„œ ë¶€ì—¬í•´ì£¼ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤!
let nextId = userData.length + 1
export function addUser(userInfo) {
    return {
        type: ADD_USER,
        payload: { ...userInfo, id: nextId++ },
    }
}

// ì´ˆê¸°ê°’
const initialState = userData

// ë¦¬ë“€ì„œ ì„ ì–¸
export default function user(state = initialState, action) {
    switch (action.type) {
        case ADD_USER:
            return [...state, { ...action.payload }]
        default:
            return state
    }
}

```

### 2) ìœ ì € ì •ë³´ Container -Presenter

containers í´ë” ë‚´ë¶€ì— UserContainer.jsxë¥¼ ë§Œë“¤ì–´ ì¤€ë‹¤.

```jsx
import { useDispatch, useSelector } from 'react-redux';
import User from '../components/User';
import { addUser } from '../modules/user';

function UserContainer() {
    const dispatch = useDispatch();
    const users = useSelector((state) => state);

    const onAdd = (userInfo) => {
        dispatch(addUser(userInfo));
    }

    return <User users={users} onAdd={onAdd} />
}

export default UserContainer
```

components í´í„° ë‚´ë¶€ì—ëŠ” ì•„ë˜ì²˜ëŸ¼ inputì„ ë°›ì•„ì„œ ì¶”ê°€í• ìˆ˜ ìˆë„ë¡ Userì»´í¬ë„ŒíŠ¸ë¥¼ ì‘ì„±í•œë‹¤.

```jsx
import React, { useState } from 'react'

function User({users, onAdd}) {
	// ì§€ê¸ˆì€ ìš°ì„  redux ê´€ë ¨ ì½”ë“œë§Œ container ì— ì‘ì„±í•˜ëŠ” ë°©ì‹ìœ¼ë¡œ ì§„í–‰í–ˆìœ¼ë‚˜,
	// ì•„ë˜ ì½”ë“œë“¤ë„ ë‚˜ëˆ ì£¼ëŠ”ê²Œ ì¢‹ê² ì£ ?
  const [userInput, setUserInput] = useState({})
  const onInputChange = (e) => {
    const {name, value} = e.target
    setUserInput({...userInput, [name]: value})
  }

  return (
    <div>
        {users.map((user) => (<p key={user.id}>{user.name}</p>))}
        <input name="name" onChange={onInputChange}></input>
        <input name="email" onChange={onInputChange}></input>
        <button onClick={() => onAdd(userInput)}>ì¶”ê°€í•˜ê¸°</button>
    </div>
  )
}

export default User
```

### 3) Combine Reducer
store ì— ì•ì„œ ì‘ì„±í–ˆë˜ counter ê´€ë ¨ ìƒíƒœì™€ ë¦¬ë“€ì„œë§Œ ë‹´ê²¨ìˆë‹¤.
ë§Œì•½ ë¦¬ë“€ì„œê°€ ì—¬ëŸ¬ê°œë¼ë©´, ì–´ë–»ê²Œ ì½”ë“œë¥¼ ì‘ì„±í•˜ë©´ ë˜ëŠ”ê°€?

ì—¬ëŸ¬ê°œì˜ ë¦¬ë“€ì„œë¥¼ `combineReducers` ë¼ëŠ” í•¨ìˆ˜ë¡œ ê°ì‹¸ê³ , í•´ë‹¹ í•¨ìˆ˜ì˜ ë¦¬í„´ê°’ìœ¼ë¡œ storeë¥¼ ë§Œë“¤ë©´ ëœë‹¤.


Containerë¥¼ ëª¨ë‘ ë³¼ìˆ˜ ìˆê²Œ app.jsì— ë¶ˆëŸ¬ì˜¨ë‹¤.

```jsx
import { Provider } from 'react-redux';
import store from './modules';
import CounterContainer from "./containers/CounterContainer";
import UserContainer from "./containers/UserContainer"

function App() {
  return (
    <Provider store={store}>
      <CounterContainer/>
      <UserContainer/>
    </Provider>
  );
}

export default App;
```

í˜„ì¬ storeì—ëŠ” ì•„ì§ë„ coutner ê´€ë ¨ ìƒíƒœì™€ ë¦¬ë“€ì„œë§Œ ë‹´ê²¨ìˆì–´ì„œ user ê´€ë ¨ ìƒíƒœë¥¼ ì¶”ê°€í•´ì¤„ í•„ìš”ê°€ ìˆë‹¤. 

index.jsì—ì„œ combineReducersë¥¼ ì‚¬ìš©í•˜ì—¬ ë¦¬ë“€ì„œë¥¼ ê²°í•©í•œë‹¤.

```jsx
import { legacy_createStore as createStore } from "redux";
import { combineReducers } from "redux";
import counter from "./counter";
import user from './user';

const rootReducer = combineReducers({
    counter,
    user
})

const store = createStore(rootReducer);

export default store;
```
App.jsxì—ì„œ ì‚¬ìš©í•˜ë˜ storeì˜ ê²½ë¡œë¥¼ ë³€ê²½í•´ì¤˜ì•¼í•œë‹¤.

```jsx
import store from './store/store'
// import store from './modules'

function App() {
    return (
        <Provider store={store}>
            <CounterContainer />
            <UserContainer />
        </Provider>
    )
}
```
### 4) Combine Reducer ì´í›„ Container ìˆ˜ì •

combineReducerë¥¼ ì‚¬ìš©í•˜ê³  ë‚œ ë’¤ì—ëŠ” useSelectorë¥¼ ì“°ëŠ” ë°©ì‹ì´ ë‹¬ë¼ì§„ë‹¤.

state.number -> state.counter.number

User ì»´í¬ë„ŒíŠ¸ì˜ ê²½ìš° state.userë¡œ ì‘ì„±
```jsx

  const users = useSelector((state) => state.user);

```

![](https://velog.velcdn.com/images/jhs000123/post/e94af306-94de-4788-b1d7-b38652d26e39/image.png)

ì´ì œ ì¹´ìš´í„°ì™€ ìœ ì € ëª©ë¡ í‘œì‹œê°€ ëœë‹¤.

### 5) ìœ ì € ì œê±°í•˜ëŠ” ë²„íŠ¼ì„ ë§Œë“¤ê³  ì‹¶ì–´

1. DELTE_USER ì•¡ì…˜ íƒ€ì… ë° ì•¡ì…˜ ì¶”ê°€
2. ë¦¬ë“€ì„œì— DELTE_USER ì¼€ì´ìŠ¤ë¥¼ ì¶”ê°€
```jsx
import { userData } from '../constants/userData'

// ì•¡ì…˜ íƒ€ì…
const ADD_USER = 'user/ADD_USER'
const DELETE_USER = 'user/DELETE_USER'

// ì•¡ì…˜ ìƒì„± í•¨ìˆ˜
// ë°±ì—”ë“œê°€ ì—†ê¸° ë•Œë¬¸ì— ì´ë ‡ê²Œ ì‘ì„±ë˜ì–´ìˆëŠ” ê²ƒë¿ì´ë©°, ì‹¤ì œ ì„œë¹„ìŠ¤ì˜ ê²½ìš° ì´ ë¶€ë¶„ì´ ì—†ì„ ê²ë‹ˆë‹¤!
// ë°ì´í„°ì˜ id ëŠ” ë°±ì—”ë“œì—ì„œ ë¶€ì—¬í•´ì£¼ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì…ë‹ˆë‹¤!
let nextId = userData.length + 1
export function addUser(userInfo) {
    return {
        type: ADD_USER,
        payload: { ...userInfo, id: nextId++ },
    }
}

export function deleteUser(userId) {
    return {
        type: DELETE_USER,
        payload: userId,
    }
}

// ì´ˆê¸°ê°’
const initialState = userData

// ë¦¬ë“€ì„œ ì„ ì–¸
export default function user(state = initialState, action) {
    switch (action.type) {
        case ADD_USER:
            return [...state, { ...action.payload }]
        case DELETE_USER:
            return state.filter((user) => user.id !== action.payload)
        default:
            return state
    }
}

```
3. onDeleteí•¨ìˆ˜ë¥¼ ì œì‘í•´ì„œ propsë¡œ ì „ë‹¬
```jsx
import React from 'react'
import { useDispatch, useSelector } from 'react-redux'
import { addUser, deleteUser } from '../modules/user'
import User from './../components/User'

function UserContainer() {
    const dispatch = useDispatch()
    const users = useSelector((state) => state.user)

    const onAdd = (userInfo) => {
        dispatch(addUser(userInfo))
    }

    const onDelete = (id) => {
        dispatch(deleteUser(id))
    }

    return <User users={users} onAdd={onAdd} onDelete={onDelete} />
}

export default UserContainer

```
4. ì»´í¬ë„ŒíŠ¸ì—ì„œ onDeleteí•¨ìˆ˜ë¥¼ ë°›ì•„ì„œ ì‚­ì œë²„íŠ¼ ì œì‘

```jsx
import React, { useState } from 'react'

function User({ users, onAdd, onDelete }) {
    const [userInput, setUserInput] = useState({})
    const onInputChange = (e) => {
        const { name, value } = e.target
        setUserInput({ ...userInput, [name]: value })
    }
    return (
        <div>
            {users.map((user) => (
                <div key={user.id}>
                    <p>{user.name}</p>
                    <button onClick={() => onDelete(user.id)}>ì œê±°</button>
                </div>
            ))}
            <input name="name" onChange={onInputChange} />
            <input name="email" onChange={onInputChange} />
            <button onClick={() => onAdd(userInput)}>ì¶”ê°€</button>
        </div>
    )
}

export default User

```

![](https://velog.velcdn.com/images/jhs000123/post/f42c2c02-d961-43b7-b9ff-42a6b9dc2a81/image.gif)

ì œê±° ë²„íŠ¼ì„ ëˆ„ë¥´ë©´ ìœ ì €ê°€ ì‚¬ë¼ì§„ë‹¤.


## Redux Middleware

### 1) redux logger
 reduxë¡œ ì‹¤í–‰ë˜ëŠ” ë¡œì§ì— ëŒ€í•´ì„œ logging, ì¦‰ ì½˜ì†”ì°½ì— ê¸°ë¡ì„ ë‚¨ê²¨ì£¼ëŠ” ì—­í• ì„ ë‹´ë‹¹í•˜ëŠ” ë¦¬ë•ìŠ¤ ë¯¸ë“¤ì›¨ì–´ì´ë‹¤. íŠ¹ë³„í•œê±´ ì•„ë‹ˆê³  ê·¸ëƒ¥ ë¦¬ë•ìŠ¤ê°€ ì‘ë™í•˜ëŠ” ê³¼ì •ì—ì„œ store,action ê°ì²´ë¥¼ ë‹¤ë£¨ë©´ì„œ íŠ¹ì •í•œ ê¸°ëŠ¥ì„ ìˆ˜í–‰í•˜ëŠ” í•¨ìˆ˜ë¥¼ ë¯¸ë“¤ì›¨ì–´ë¼ê³  í•œë‹¤. 
 
 > yarn add redux-logger --dev
 
 ê·¸ë¦¬ê³  storeì—ì„œ createStoreì— ì¶”ê°€ì ìœ¼ë¡œ í”„ë¡œí¼í‹°ë¥¼ ì‘ì„±í•œë‹¤.
 ```jsx
import { applyMiddleware, legacy_createStore as createStore } from "redux";
import logger from 'redux-logger';

const store = createStore(rootReducer, applyMiddleware(logger));
 ```
 ê·¸ë¦¬ê³  ë‹¤ì‹œ ì‹œì‘í•´ì„œ ì•„ë¬´ê±°ë‚˜ ì‚­ì œë¥¼ í•´ë³´ë©´
 ì½˜ì†”ì°½ì—ì„œ ì•„ë˜ì™€ ê°™ì´ action, prev state, nexstateë¥¼ ë³´ì—¬ì£¼ê²Œëœë‹¤. 
 
 ![](https://velog.velcdn.com/images/jhs000123/post/42f2da95-6252-459b-87c1-77cda086fc95/image.png)

### 2) redux devtools
í¬ë¡¬ì—ì„œ redux ì „ìš© ê°œë°œì ë„êµ¬ë¥¼ í™œìš©í• ìˆ˜ ìˆë„ë¡ í•´ì¤€ë‹¤.
[https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd](https://chrome.google.com/webstore/detail/redux-devtools/lmhkpmbekcpmknklioeibfkpmmfibljd)
ì—¬ê¸°ë¥¼ ë“¤ì–´ê°€ì„œ í™•ì¥ í”„ë¡œê·¸ë¨ ì„¤ì¹˜ë¥¼ í•´ì£¼ê³  storeì—ì„œ ì½”ë“œë¥¼ ì¶”ê°€í•œ ë‹¤ìŒ ì‹¤í–‰í•˜ë©´ 

```jsx
import counter from '../reducers/counter'
import { applyMiddleware, combineReducers, compose, legacy_createStore as createStore } from 'redux'
import user from '../modules/user'
import logger from 'redux-logger'
const rootReducer = combineReducers({
    counter,
    user,
})
const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose
const store = createStore(rootReducer, composeEnhancers(applyMiddleware(logger)))

export default store

```

![](https://velog.velcdn.com/images/jhs000123/post/c918d796-78df-4c98-971b-cde90cf71434/image.png)

ì´ë ‡ê²Œ stateì™€ ë™ì‘í•œ ê¸°ë¡ë“¤ì„ í™•ì¸í•´ë³¼ìˆ˜ ìˆë‹¤.

### 3) redux persist

reduxë¡œ ê´€ë¦¬í•˜ëŠ” ìƒíƒœê°’ì„ ë¸Œë¼ìš°ì €ì— ì €ì¥í•´ë†“ê³ , ìƒˆë¡œê³ ì¹¨ í›„ì—ë„ í•´ë‹¹ ê°’ì„ ë¶ˆëŸ¬ì™€ì„œ ì‚¬ìš©í• ìˆ˜ ìˆë„ë¡ ë„ì™€ì£¼ëŠ” ë¼ì´ë¸ŒëŸ¬ë¦¬ì´ë‹¤.

> yarn add redux-persist

1. store.js ì— í•´ë‹¹ config ì½”ë“œë¥¼ ì¶”ê°€í•œë‹¤
2. configê°€ ì ìš©ëœ psersistedReducerë¥¼ ìƒì„±í•œë‹¤. í˜„ì¬ counter ë¦¬ë“€ì„œì˜ stateëŠ” ì €ì¥í•˜ê³  userëŠ” ì €ì¥í•˜ì§€ ì•ŠëŠ” ê²ƒìœ¼ë¡œ ì„¤ì •í•œ ìƒíƒœì´ë©° ë°ì´í„°ê°’ì„ ë¡œì»¬ ìŠ¤í† ë¦¬ì§€ì— ì €ì¥í•œë‹¤.
3. í•´ë‹¹ storeë¥¼ persistStoreì— ê°ì‹¸ì¤€ ê²ƒì„ persistor ë¼ëŠ” ì´ë¦„ìœ¼ë¡œ export í•œë‹¤. 

- localStorage â†’Â `import storage from 'redux-persist/lib/storage'`
- sessionStorage â†’Â `import storageSession from 'redux-persist/lib/storage/session'`

```jsx

import { applyMiddleware, combineReducers, compose, legacy_createStore as createStore } from 'redux'
import user from '../modules/user'
import storage from 'redux-persist/lib/storage'
import { persistReducer, persistStore } from 'redux-persist'
import counter from './../modules/counter'

const persistConfig = {
    key: 'root', // ì„ì˜ì˜ key ê°’
    storage: storage, // ì •í™•íˆ ì–´ë–¤ storage ì— ì €ì¥í• ì§€
    whitelist: ['counter'], // ê°’ì„ ì €ì¥í•  ë¦¬ë“€ì„œëª…
    blacklist: ['user'], // ê°’ì„ ì €ì¥í•˜ì§€ ì•Šì„ ë¦¬ë“€ì„œëª…
}
const rootReducer = combineReducers({
    counter,
    user,
})

const persistedReducer = persistReducer(persistConfig, rootReducer)

export const store = createStore(persistedReducer)
export const persistor = persistStore(store)
// const composeEnhancers = window.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__ || compose


```

ê·¸ë‹¤ìŒ app.jsxì—ì„œ `PersistGate`ë¡œ ì»¨í…Œì´ë„ˆë¥¼ ê°ì‹¸ê³  ,persistStoreë¡œ ë§Œë“  persistorë¥¼ ëª…ì‹œí•˜ë©´ ëœë‹¤.

```jsx
import { Provider } from 'react-redux'
import { PersistGate } from 'redux-persist/integration/react'
import CounterContainer from './containers/CounterContainer'
import UserContainer from './containers/UserContainer'
import { persistor, store } from './store/store'
// import store from './modules'
import { Loading } from './../../seventhApp/src/components/Common/Loading/style'

function App() {
    return (
        <Provider store={store}>
            <PersistGate persistor={persistor}>
                <CounterContainer />
                <UserContainer />
            </PersistGate>
        </Provider>
    )
}

export default App

```

ì´ë ‡ê²Œ í•´ì£¼ë©´ counter ì»´í¬ë„ˆíŠ¸ì˜ ìˆ«ìë¥¼ ë³€ê²½í•œ ë‹¤ìŒì— ìƒˆë¡œê³ ì¹¨ì„ í•´ë„ ê·¸ ê°’ì´ ìœ ì§€ë˜ëŠ” ê²ƒì„ í™•ì¸í• ìˆ˜ ìˆë‹¤.



![](https://velog.velcdn.com/images/jhs000123/post/e3d6fc1c-1f5e-4aac-a39f-e8471ca8997c/image.png)




